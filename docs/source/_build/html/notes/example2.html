
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Example: excitations &#8212; AD-PEPS  documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="adpeps.ipeps.ipeps" href="../generated/adpeps.ipeps.ipeps.html" />
    <link rel="prev" title="Example: ground state" href="example.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../index.html">
<p class="title">AD-PEPS</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="install.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="start.html">
  Getting Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="example.html">
  Example: ground state
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="current reference internal nav-link" href="#">
  Example: excitations
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../generated/adpeps.ipeps.ipeps.html">
  adpeps.ipeps.ipeps
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../generated/adpeps.ipeps.config.html">
  adpeps.ipeps.config
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../generated/adpeps.ipeps.ctm.html">
  adpeps.ipeps.ctm
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../generated/adpeps.ipeps.models.html">
  adpeps.ipeps.models
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../generated/adpeps.simulation.html">
  adpeps.simulation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../generated/adpeps.utils.html">
  adpeps.utils
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="install.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="start.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="example.html">
   Example: ground state
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Example: excitations
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/adpeps.ipeps.ipeps.html">
   adpeps.ipeps.ipeps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/adpeps.ipeps.config.html">
   adpeps.ipeps.config
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../generated/adpeps.ipeps.ctm.html">
   adpeps.ipeps.ctm
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../generated/adpeps.ipeps.models.html">
   adpeps.ipeps.models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/adpeps.ipeps.models.common.html">
     adpeps.ipeps.models.common
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/adpeps.ipeps.models.heisenberg.html">
     adpeps.ipeps.models.heisenberg
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../generated/adpeps.simulation.html">
   adpeps.simulation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/adpeps.simulation.run_ipeps_exci.html">
     adpeps.simulation.run_ipeps_exci
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/adpeps.simulation.run_ipeps_gs.html">
     adpeps.simulation.run_ipeps_gs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../generated/adpeps.utils.html">
   adpeps.utils
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/adpeps.utils.ctmtensors.html">
     adpeps.utils.ctmtensors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/adpeps.utils.empty_tensor.html">
     adpeps.utils.empty_tensor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/adpeps.utils.io.html">
     adpeps.utils.io
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/adpeps.utils.nested.html">
     adpeps.utils.nested
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/adpeps.utils.printing.html">
     adpeps.utils.printing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/adpeps.utils.tlist.html">
     adpeps.utils.tlist
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="example-excitations">
<span id="notes-example2"></span><h1>Example: excitations<a class="headerlink" href="#example-excitations" title="Permalink to this headline">Â¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example continues from <a class="reference internal" href="example.html#notes-example"><span class="std std-ref">the ground-state example</span></a> and requires an optimized ground state to start from.</p>
</div>
<p>Here we demonstrates how to use the <code class="xref py py-mod docutils literal notranslate"><span class="pre">adpeps</span></code> package for computing excited states of the 2D Heisenberg model.</p>
<p>The configuration file <cite>examples/heis_D2_exci.yaml</cite> contains the following settings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Base configuration file for iPEPS simulation</span>
<span class="c1"># See the individual config modules for more information</span>

<span class="c1"># Simulation options</span>
<span class="c1"># -&gt; ipeps/config.py</span>
<span class="n">D</span><span class="p">:</span>             <span class="mi">2</span>
<span class="n">chi</span><span class="p">:</span>           <span class="mi">40</span>
<span class="n">model</span><span class="p">:</span>         <span class="s1">&#39;heisenberg&#39;</span>

<span class="c1"># Prefix for output file</span>
<span class="n">out_prefix</span><span class="p">:</span>

<span class="c1"># Resume earlier simulation if found</span>
<span class="n">resume</span><span class="p">:</span>        <span class="kc">True</span>

<span class="n">model_params</span><span class="p">:</span>
  <span class="n">J</span><span class="p">:</span>           <span class="mi">1</span>

<span class="c1"># Set to 0 to suppress all output besides printing each step</span>
<span class="n">disp_level</span><span class="p">:</span>    <span class="mi">1</span>

<span class="c1"># CTM convergence criterium (singular values norm difference)</span>
<span class="n">ctm_conv_tol</span><span class="p">:</span>  <span class="mf">1.e-6</span>

<span class="c1"># Minimal number of CTM steps</span>
<span class="n">ctm_min_iter</span><span class="p">:</span>  <span class="mi">4</span>

<span class="c1"># Maximal number of CTM steps</span>
<span class="n">ctm_max_iter</span><span class="p">:</span>  <span class="mi">20</span>

<span class="c1"># Flush output (prints with print(*args, flush=True))</span>
<span class="n">flush_output</span><span class="p">:</span>  <span class="kc">True</span>

<span class="c1"># Unit cell pattern (Neel order)</span>
<span class="n">pattern</span><span class="p">:</span>
  <span class="p">[</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
  <span class="p">]</span>

<span class="c1"># Excitations</span>
<span class="n">momentum_path</span><span class="p">:</span> <span class="s1">&#39;Bril1&#39;</span>
</pre></div>
</div>
<p>Note that many of the options are the same as for the ground-state simulation, with the addition of the <a class="reference internal" href="../generated/adpeps.ipeps.config.html#adpeps.ipeps.config.momentum_path" title="adpeps.ipeps.config.momentum_path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">adpeps.ipeps.config.momentum_path</span></code></a> setting, which controls which path through the Brillouin zone will be taken.</p>
<p>In the configuration for excited states you do not explicitly set the momentum, but choose a preset path of points in momentum space and pass the index for each simulation.</p>
<p>If we now start the simulation, we get the following response:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">adpeps</span> <span class="n">exci</span> <span class="s1">&#39;heis_D2_exci&#39;</span> <span class="o">--</span><span class="n">p_ix</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">...</span>
<span class="go">Running excited-state sim</span>
<span class="gp">...</span>
<span class="go">Base file .../exci/heisenberg_D2_X40.base.npz not found.</span>
<span class="go">Prepare the simulation first by running with option &#39;-i&#39;</span>
</pre></div>
</div>
<p>What happened is that we first need to make some preparations for the simulation.
For excited-state simulations, we require the following:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Well-converged CTM boundary tensors</p></li>
<li><p>A basis for the excited-state tensors, orthogonal to the ground state</p></li>
</ol>
</div></blockquote>
<p>The preparations for the simulation need to be performed only once, resulting in a <cite>base</cite> simulation file that will be used by the simulations for every momentum.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">adpeps</span> <span class="n">exci</span> <span class="s1">&#39;heis_D2_exci&#39;</span> <span class="o">-</span><span class="n">i</span>
<span class="gp">...</span>
<span class="go">Running excited-state sim</span>
<span class="gp">...</span>
<span class="go">  | CTM step 1 conv: 1.036e-01 time: 3.64 obj: -0.665574</span>
<span class="go">  | CTM step 2 conv: 3.137e-03 time: 4.23 obj: -0.662436</span>
<span class="go">  | CTM step 3 conv: 7.887e-05 time: 4.0 obj: -0.662515</span>
<span class="go">  | CTM step 4 conv: 1.388e-06 time: 2.2 obj: -0.662514</span>
<span class="go">  | CTM step 5 conv: 2.455e-07 time: 1.35 obj: -0.662514</span>
<span class="go">  | CTM step 6 conv: 3.044e-08 time: 1.35 obj: -0.662514</span>
<span class="go">  | CTM step 7 conv: 4.673e-09 time: 1.37 obj: -0.662514</span>
<span class="go">  | CTM step 8 conv: 4.467e-10 time: 1.36 obj: -0.662514</span>
<span class="go">  | CTM step 9 conv: 5.029e-11 time: 1.35 obj: -0.662514</span>
<span class="go">  | CTM step 10 conv: 5.612e-11 time: 1.38 obj: -0.662514</span>
<span class="go">  | CTM step 11 conv: 2.801e-11 time: 1.36 obj: -0.662514</span>
<span class="go">  | CTM step 12 conv: 1.204e-11 time: 1.65 obj: -0.662514</span>
<span class="go">  | CTM step 13 conv: 4.936e-12 time: 1.42 obj: -0.662514</span>
<span class="go">  | CTM step 14 conv: 1.989e-12 time: 1.39 obj: -0.662514</span>
<span class="go">GS norm 3.5890188873039093</span>
<span class="go">GS norm 1.0</span>
<span class="go">Substracting -0.33125703308289145 from Hamiltonian</span>
</pre></div>
</div>
<p>Several steps have been performed: first a full CTM contraction of the ground-state network, followed by a normalization of the ground-state tensors.
Then the Hamiltonian is shifted by the ground-state energy expectation value, in order for the excitations to have energies relative to the ground state.
Finally, the basis is prepared and we have everything to get started.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">adpeps</span> <span class="n">exci</span> <span class="s1">&#39;heis_D2_exci&#39;</span> <span class="o">--</span><span class="n">p_ix</span><span class="o">=</span><span class="mi">0</span>
<span class="gp">...</span>
<span class="go">Running excited-state sim</span>
<span class="gp">...</span>
<span class="go">Starting simulation of basis vector 1/62</span>
<span class="go">Performing CTM</span>
<span class="go">  | CTM step 1 conv: 4.236e+00 time: 3.19 obj: 5.173629</span>
<span class="go">  | CTM step 2 conv: 3.539e-02 time: 1.38 obj: 5.138237</span>
<span class="go">  | CTM step 3 conv: 6.139e-03 time: 1.27 obj: 5.132099</span>
<span class="go">  | CTM step 4 conv: 2.116e-04 time: 1.24 obj: 5.132310</span>
<span class="go">  | CTM step 5 conv: 6.148e-05 time: 1.28 obj: 5.132249</span>
<span class="go">  | CTM step 6 conv: 3.704e-04 time: 1.25 obj: 5.131879</span>
<span class="go">  | CTM step 7 conv: 2.493e-04 time: 1.25 obj: 5.131629</span>
<span class="go">Energies: 0.04418993415167889 1.5450126399606245e-10</span>
<span class="go">Norm: 0.008611083119254162</span>
<span class="go">==========</span>
<span class="go">Finished basis vector 1/62</span>
<span class="go">-</span>
<span class="go">Starting simulation of basis vector 2/62</span>
<span class="go">Performing CTM</span>
<span class="go">  | CTM step 1 conv: 2.004e+00 time: 0.99 obj: 3.335621</span>
<span class="go">  | CTM step 2 conv: 6.150e-02 time: 1.26 obj: 3.397117</span>
<span class="go">  | CTM step 3 conv: 2.017e-02 time: 1.28 obj: 3.376950</span>
<span class="go">  | CTM step 4 conv: 3.838e-03 time: 1.26 obj: 3.380788</span>
<span class="go">  | CTM step 5 conv: 3.650e-04 time: 1.3 obj: 3.380423</span>
<span class="go">  | CTM step 6 conv: 1.246e-03 time: 1.29 obj: 3.381669</span>
<span class="go">  | CTM step 7 conv: 1.288e-03 time: 1.31 obj: 3.380380</span>
<span class="go">Energies: 0.4285335373465171 1.5450126399606245e-10</span>
<span class="go">Norm: 0.12679967208649232</span>
<span class="go">==========</span>
<span class="go">Finished basis vector 2/62</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>In this version of the algorithm, the full energy and norm overlap matrices will be computed.
Each of the basis vectors, as seen in the output above, is used as input in a separate CTM summation and the program will continue to run until all basis vectors have been used.</p>
</div>


              </div>
              
              
          </main>
          

      </div>
    </div>
    
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Boris Ponsioen.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>